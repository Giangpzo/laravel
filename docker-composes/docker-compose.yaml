version: '3.9'

services:
  server:
    image: 'nginx:latest'
    ports:
      - '8082:80'
    volumes:
      - ../nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
      - ../nginx/log:/var/log/nginx
      - ../src:/var/www/html
    extra_hosts:
      - "host.docker.internal:host-gateway"
  #    depends_on:
  #      - php
  #    links:
  #      - php

  php:
    build:
      context: ../dockerfiles
      dockerfile: php.dockerfile
    ports:
      - '3000:9000'
    volumes:
      - ../src:/var/www/html:delegated
    extra_hosts:
      - "host.docker.internal:host-gateway"